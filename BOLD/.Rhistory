setwd( "/home/lmalpica/Desktop/CONABIO")
library(readr)
library(dplyr)
library(tidyr)
bold_data[bold_data$phylum_name=="Chlorarachniophyta", 10]<-"Chlorarachniophyceae"
setwd( "/home/lmalpica/Desktop/CONABIO")
library(readr)
library(dplyr)
library(tidyr)
bold_data <- read_delim("~/Desktop/CONABIO/bold_data.tsv", "\t", escape_double = FALSE, trim_ws = TRUE)
setwd( "/home/lmalpica/Desktop/CONABIO")
library(readr)
library(dplyr)
library(tidyr)
bold_data <- read_delim("~/Desktop/CONABIO/bold_data.tsv", "\t", escape_double = FALSE, trim_ws = TRUE)
bold_data<-as.data.frame(bold_data)
bold_data[bold_data$phylum_name=="Chlorarachniophyta", 10]<-"Chlorarachniophyceae"
bold_data[bold_data$phylum_name=="Glomeromycota",10]<-"Glomeromycotina"
bold_data[bold_data$phylum_name=="Phoronida",10]<-"Phoroniformea"
setwd( "/home/lmalpica/Desktop/CONABIO")
library(readr)
library(dplyr)
library(tidyr)
bold_data <- read_delim("~/Desktop/CONABIO/bold_data.tsv", "\t", escape_double = FALSE, trim_ws = TRUE)
bold_data<-as.data.frame(bold_data)
bold_data[1:10,]
setwd( "/home/lmalpica/Desktop/CONABIO")
library(readr)
library(dplyr)
library(tidyr)
bold_data <- read_delim("~/Desktop/CONABIO/bold_data.tsv", "\t", escape_double = FALSE, trim_ws = TRUE)
bold_data<-as.data.frame(bold_data)
View(bold_data[1:10,])
setwd( "/home/lmalpica/Desktop/CONABIO")
library(readr)
library(dplyr)
library(tidyr)
bold_data <- read_delim("~/Desktop/CONABIO/bold_data.tsv", "\t", escape_double = FALSE, trim_ws = TRUE)
bold_data<-as.data.frame(bold_data)
bold_data[1:10,]
bold_data[bold_data$phylum_name=="Chlorarachniophyta", 10]<-"Chlorarachniophyceae"
bold_data[bold_data$phylum_name=="Glomeromycota",10]<-"Glomeromycotina"
bold_data[bold_data$phylum_name=="Phoronida",10]<-"Phoroniformea"
phylumid_kingdom$kingdom[4]<-"Bacteria"
phylumid_kingdom <- read_delim("~/Desktop/CONABIO/phylumid_kingdom.tsv",  "\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
phylumid_kingdom <- read_delim("~/Desktop/CONABIO/phylumid_kingdom.tsv",  "\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
phylumid_kingdom <- read_delim("~/Desktop/CONABIO/phylumid_kingdom.tsv",  "\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
colnames(phylumid_kingdom)<-c("phylum_id", "phylum_name", "kingdom")
phylumid_kingdom <- read_delim("~/Desktop/CONABIO/phylumid_kingdom.tsv",  "\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
colnames(phylumid_kingdom)<-c("phylum_id", "phylum_name", "kingdom")
View(phylumid_kingdom)
phylumid_kingdom<-phylumid_kingdom[-7,]
phylumid_kingdom$kingdom[4]<-"Bacteria"
phylumid_kingdom$kingdom[7]<-"Archaea"
phylumid_kingdom$kingdom[8]<-"Bacteria"
phylumid_kingdom$kingdom[15]<-"Archaea"
phylumid_kingdom$kingdom[12]<-"Protista"
phylumid_kingdom$kingdom[13]<-"Protista"
phylumid_kingdom$kingdom[16]<-"Protista"
phylumid_kingdom$kingdom[17]<-"Protista"
phylumid_kingdom$kingdom[29]<-"Protista"
phylumid_kingdom$kingdom[4]<-"Bacteria"
phylumid_kingdom$kingdom[7]<-"Archaea"
phylumid_kingdom$kingdom[8]<-"Bacteria"
phylumid_kingdom$kingdom[15]<-"Archaea"
phylumid_kingdom[39,]<-c(NA, "Cryptophycophyta", "Protista")
phylumid_kingdom[40,]<-c(NA, "Heterokontophyta", "Protista")
phylumid_kingdom[41,]<-c(NA, "Ochrophyta", "Protista")
phylumid_kingdom[42,]<-c(NA, "Pinophyta", "Viridiplantae")
phylumid_kingdom[43,]<-c(NA, "Pteridophyta", "Viridiplantae")
phylumid_kingdom[44,]<-c(NA, "Pyrrophycophyta", "Protista")
phylumid_kingdom[45,]<-c(NA, "Zygomycota", "Fungi")
matched_phylum<-match(bold_data$phylum_name, phylumid_kingdom$phylum_name)
bold_data$kingdom<-phylumid_kingdom$kingdom[matched_phylum]
species_seqs<-as.data.frame(table(as.factor(bold_data$species_name)))
colnames(species_seqs)<- c("species_name", "number_seqs")
species_seqs[1:10,]
species_seqs<-as.data.frame(table(as.factor(bold_data$species_name)))
colnames(species_seqs)<- c("species_name", "number_seqs")
seqs_nospecies<-nrow(bold_data)-sum(species_seqs$number_seqs)
species_seqs<-cbind(as.character(species_seqs$species_name), species_seqs$number_seqs)
species_seqs<-as.data.frame(species_seqs)
nospecies<-cbind("No_species", seqs_nospecies)
colnames(nospecies)<-c("species_name", "number_seqs")
colnames(species_seqs)<-c("species_name", "number_seqs")
species_seqs<-rbind(species_seqs, nospecies)
species_seqs[1:10,]
bold_phyl_king<-bold_data%>% group_by(phylum_name, kingdom) %>% summarise(n())
colnames(bold_phyl_king)<-c("Phylum", "Kingdom", "Num_seqs")
king_seqs<-bold_phyl_king%>%group_by(Kingdom)%>%summarise(sum(Num_seqs))
colnames(king_seqs)<-c("kingdom", "num_seqs")
bold_phyl_king<-bold_data%>% group_by(phylum_name, kingdom) %>% summarise(n())
colnames(bold_phyl_king)<-c("Phylum", "Kingdom", "Num_seqs")
king_seqs<-bold_phyl_king%>%group_by(Kingdom)%>%summarise(sum(Num_seqs))
colnames(king_seqs)<-c("kingdom", "num_seqs")
phylum_seqs<-as.data.frame(table(as.factor(bold_data$phylum_name)))
colnames(phylum_seqs)<-c("Phylum", "Num_seqs")
seqs_no_phyl<-nrow(bold_data)-sum(phylum_seqs$Num_seqs)
phylum_plot1<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs<=30,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
library(ggplot2)
library(plotly)
phylum_plot1<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs<=30,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot2<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>30 & phylum_seqs$Num_seqs<200,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot3<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>=200 & phylum_seqs$Num_seqs<1000,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot4<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>=1000,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
grid.arrange(phylum_plot1, phylum_plot2, phylum_plot3, phylum_plot4, nrow = 2)
library(ggplot2)
library(plotly)
library(grid)
library(gridExtra)
phylum_plot1<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs<=30,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot2<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>30 & phylum_seqs$Num_seqs<200,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot3<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>=200 & phylum_seqs$Num_seqs<1000,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot4<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>=1000,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
grid.arrange(phylum_plot1, phylum_plot2, phylum_plot3, phylum_plot4, nrow = 2)
library(ggplot2)
library(plotly)
library(grid)
library(gridExtra)
phylum_plot1<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs<=30,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot2<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>30 & phylum_seqs$Num_seqs<200,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot3<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>=200 & phylum_seqs$Num_seqs<1000,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot4<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>=1000,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
grid.arrange(phylum_plot1, phylum_plot2, phylum_plot3, phylum_plot4, nrow = 1)
library(ggplot2)
library(plotly)
library(grid)
library(gridExtra)
phylum_plot1<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs<=30,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot2<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>30 & phylum_seqs$Num_seqs<200,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot3<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>=200 & phylum_seqs$Num_seqs<1000,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot4<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>=1000,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot1
phylum_plot2
phylum_plot3
phylum_plot4
library(ggplot2)
library(plotly)
library(grid)
library(gridExtra)
king_plot1<-ggplot(data=king_seqs, aes(x=kingdom, y=num_seqs, fill=kingdom)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
king_plot2<-ggplot(data=king_seqs[-4,], aes(x=kingdom, y=num_seqs, fill=kingdom)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
library(ggplot2)
library(plotly)
library(grid)
library(gridExtra)
king_plot1<-ggplot(data=king_seqs, aes(x=kingdom, y=num_seqs, fill=kingdom)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
king_plot2<-ggplot(data=king_seqs[-4,], aes(x=kingdom, y=num_seqs, fill=kingdom)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
king_plot1
king_plot2
view(bold_phyl_king)
View(bold_phyl_king)
bold_phyl_king<-bold_data%>% group_by(phylum_name, kingdom) %>% summarise(n())
bold_phyl_king<-bold_data%>% group_by(phylum_name, kingdom) %>% summarise(n())
colnames(bold_phyl_king)<-c("Phylum", "Kingdom", "Num_seqs")
king_seqs<-bold_phyl_king%>%group_by(Kingdom)%>%summarise(sum(Num_seqs))
colnames(king_seqs)<-c("kingdom", "num_seqs")
phylum_seqs<-as.data.frame(table(as.factor(bold_data$phylum_name)))
colnames(phylum_seqs)<-c("Phylum", "Num_seqs")
seqs_no_phyl<-nrow(bold_data)-sum(phylum_seqs$Num_seqs)
library(ggplot2)
library(plotly)
library(grid)
library(gridExtra)
king_plot1<-ggplot(data=king_seqs, aes(x=kingdom, y=num_seqs, fill=kingdom)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
king_plot2<-ggplot(data=king_seqs[-4,], aes(x=kingdom, y=num_seqs, fill=kingdom)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
king_plot1
king_plot2
library(ggplot2)
library(plotly)
library(grid)
library(gridExtra)
phylum_plot1<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs<=30,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot2<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>30 & phylum_seqs$Num_seqs<200,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot3<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>=200 & phylum_seqs$Num_seqs<1000,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot4<-ggplot(data=phylum_seqs[phylum_seqs$Num_seqs>=1000,], aes(x=Phylum, y=Num_seqs, fill=Phylum)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
phylum_plot1
phylum_plot2
phylum_plot3
phylum_plot4
class_phyl_king<-bold_data%>% group_by(phylum_name, kingdom) %>% summarise(n())
class_phyl_king<-bold_data%>% group_by(phylum_name, kingdom) %>% summarise(n())
View(class_phyl_king)
class_phyl_king<-bold_data%>% group_by(class_name, kingdom) %>% summarise(n())
View(class_phyl_king)
bold_class_king<-bold_data%>% group_by(class_name, kingdom) %>% summarise(n())
View(bold_class_king)
bold_class_king<-bold_data%>% group_by(class_name, kingdom) %>% summarise(n())
colnames(bold_phyl_king)<-c("Class", "Kingdom", "Num_seqs")
bold_class_king<-bold_data%>% group_by(class_name, kingdom) %>% summarise(n())
colnames(bold_phyl_king)<-c("Class", "Kingdom", "Num_seqs")
bold_class_king<-bold_data%>% group_by(class_name, kingdom) %>% summarise(n())
colnames(bold_class_king)<-c("Class", "Kingdom", "Num_seqs")
bold_class_king<-bold_data%>% group_by(class_name, kingdom) %>% summarise(n())
colnames(bold_class_king)<-c("Class", "Kingdom", "Num_seqs")
classes_metazoa<-bold_class_king[bold_class_king$Class=="Metazoa",]
bold_class_king<-bold_data%>% group_by(class_name, kingdom) %>% summarise(n())
colnames(bold_class_king)<-c("Class", "Kingdom", "Num_seqs")
classes_metazoa<-bold_class_king[bold_class_king$Kingdom=="Metazoa",]
classes_viridiplantae<-bold_class_king[bold_class_king$Kingdom=="Viridiplantae",]
classes_protista<-bold_class_king[bold_class_king$Kingdom=="Protista",]
classes_fungi<-bold_class_king[bold_class_king$Kingdom=="Fungi",]
classes_archaea<-bold_class_king[bold_class_king$Kingdom=="Archaea",]
classes_bacteria<-bold_class_king[bold_class_king$Kingdom=="Bacteria",]
ggplot(data=classes_metazoa, aes(x=Class, y=Num_seqs, fill=Class)) +
geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 90))
bold_latlon<-bold_data[!is.na(bold_data$lon),]
bold_latlon<-bold_latlon[!is.na(bold_latlon$lat),]
